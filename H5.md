# H5 Miniprojekti
## IT-ympäristön pystytys
Projektin tavoitteena oli harjoitella IT-ympäristön automatisointia Vagrantin ja SaltStackin avulla. Tarkoituksena oli simuloida työelämässä mahdollisesti vastaan tulevaa IT-ympäristön pystytystä käyttämällä infrastruktuuria koodina -periaatetta. Projektissa luotiin kuusi virtuaalikonetta, joista yksi on mestari kone, joka hoitaa kaiken työn.

Koneille määriteltiin selkeät roolit:
* Web-palvelin (web)
* Tietokantapalvelin (database)
* Monitorointipalvelin (monitor)
* Käyttäjäkoneet (user1, user2)

Jokaiselle koneelle asennettiin automaattisesti sen roolia vastaavat ohjelmistot.

## Vagrant-file
Aloitin tekemällä kansion "projekti" komennolla `mkdir projekti`, jonka jälkeen siirryin kansioon `cd projekti` komennolla.
Sitten loin vagrant filen komennolla `vagrant init`.
Halusin automatisoida kaikille koneille saltin asennuksen scriptin avulla, koska tämä säästäisi aikaa ja työelämässä koneita voisi olla paljon enemmän, kuin minulla tässä projektissa.

Tein siis vagrant fileen seuraavanlaiset scriptit ja seurasin näissä ohjeita Teron linkkaamista artikkeleista: 
* https://terokarvinen.com/2018/03/28/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/
* https://docs.saltproject.io/salt/install-guide/en/latest/topics/install-by-operating-system/linux-deb.html
* https://terokarvinen.com/2021/two-machine-virtual-network-with-debian-11-bullseye-and-vagrant/
![Scripti](https://github.com/user-attachments/assets/afb11311-3500-455b-861e-3637fd831fa4)
![image](https://github.com/user-attachments/assets/0578e16a-37d9-4158-bce4-5b4cb131da50)

## Minion hyväksyminen ja roolien jako
Nyt kun salt-minion ja master on asennettu oikeille koneille pystyin heti hyväksymään avaimet komennolla `sudo salt-key -A`:

![Minionhyväksyminen](https://github.com/user-attachments/assets/fdb35489-83d0-4485-80ff-407ac480ef1e)

Tämän jälkeen varmistin että yhteys minioneihin toimii komennolla `sudo salt '*' cmd.run 'whoami'`:

![Kommunikointitesti](https://github.com/user-attachments/assets/867fd110-e31b-4c0d-bacc-bda2c00c0f31)

Sitten tuli aika jakaa roolit koneille. Tämän päätin tehdä top.sls tiedoston avulla. Loin aluksi pääkansion komennolla `sudo mkdir /srv/salt/`, siirryin kansioon `cd /srv/salt/` ja loin top.sls tiedoston komennolla `sudoedit top.sls`:

![top sls](https://github.com/user-attachments/assets/a453a5c4-999a-40ac-8480-013b9119e9af)

## Roolien kansiot ja init.sls
Sitten loin jokaiselle roolille oman kansion ja näihin kansioihin roolikohtaiset init.sls tiedostot. 
